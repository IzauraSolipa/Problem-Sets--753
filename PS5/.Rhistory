library(ggplot2)
library(foreign)
library(rmarkdown)
library(fastDummies)
library(haven)
library(pmdplyr)
library(plotrix)
library(foreign)
options(scipen=10000)
options(digits=4)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
library(XLConnect)
install.packages("XLConnect","reshape2")
?melt
data<-import("FRB_Z1")
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1")
data<-import("FRB_Z1.csv")
View(data)
data<-data %>% slice(-c(1:6))
View(data)
mean(data$`Nonfinancial corporate business; corporate profits before tax excluding IVA and CCAdj`)
data<-data %>% mutate(across(everything(),as.numeric))
View(data)
?gsub
colnames(data)<-sapply(strsplit(colnames(data), split=';',fixed=TRUE),fuction(x)(x[2]))
colnames(data)<-sapply(strsplit(colnames(data), split=';',fixed=TRUE), fuction(x)(x[2]))
?str_remove
??str_remove
names<-colnames(data)
install.packages("stringr")
library(stringr)
names<-s1 = unlist(strsplit(names, split=';', fixed=TRUE))[2]
names<- unlist(strsplit(names, split=';', fixed=TRUE))[2]
names
names<-colnames(data)
names<- unlist(strsplit(names, split=';', fixed=TRUE))
names
names
names<-str_replace(names, "Nonfinancial corporate business")
names<-str_replace(names, "Nonfinancial corporate business","")
names
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business;","")
colnames(data)<-names
View(data)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business;","")
names<-str_replace(names," ",".")
names<-str_replace(names, ";", "_")
colnames(data)<-names
View(data)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business; ","")
names<-str_replace(names," ",".")
names<-str_replace(names, ";", "_")
colnames(data)<-names
View(data)
data<-import("FRB_Z1.csv")
View(data)
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business; ","")
names<-str_replace(names," ",".")
names<-str_replace(names, ";", "_")
colnames(data)<-names
View(data)
??str_replace
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business; ","")
names<-str_replace(names," ",".",all=TRUE)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace(names, "Nonfinancial corporate business; ","")
names<-str_replace(names," ", ".")
names<-str_replace(names, ";", "_")
colnames(data)<-names
View(data)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
View(data)
data<-data %>% mutate(IF=corporate.profits.before.tax.excluding.IVA.and.CCAdj-
taxes.on.corporate.income-
net.dividends.paid +
foreign.earnings.retained.abroad+
`inventory.valuation.adjustment.(IVA)`-
net.capital.transfers.paid.)
View(data)
data$IF
data<-data %>% relocate("IF")
View(data)
data<-data %>% rename("gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid"="Total_Internal_Funds")
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets")
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_Lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial account)")
names
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_Lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:6))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_Lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)",
"year=Series.Description")
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_Lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)",
"year"="Series.Description")
data<-data %>% select(year, Total_Internal_Funds, FI,Net_acquisition_assets, Net_Lending_borrowing)
View(data)
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:5))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_Internal_Funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_Lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)",
"year"="Series.Description")
data<-data %>% select(year, Total_Internal_Funds, FI,Net_acquisition_assets, Net_Lending_borrowing)
View(data)
data<-data %>% mutate(Net_Increase_Liabilities=Net_acquisition_assets-Net_lending_borrowing)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
# PART 2 #
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:5))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_internal_funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)",
"year"="Series.Description")
data<-data %>% select(year, Total_internal_funds, FI, Net_acquisition_assets, Net_lending_borrowing)
data<-data %>% mutate(Net_increase_liabilities=Net_acquisition_assets-Net_lending_borrowing)
View(data)
data<-data %>% mutate(IF.FI.ratio=Total_internal_funds/FI, NIL.FI.ratio=Net_increase_liabilities/FI)
ggplot(data)+ geom_line(aes(y=IF.FI.ratio,year))+geom_line(aes(y=NIL.FI.ratio,x=year))
??ggplot
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio))+geom_line(aes(y=NIL.FI.ratio,)) + theme_bw()
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio))+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"))+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange", size=1))+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange", size=.5))+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"))+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1)+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1)+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio") +labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment")
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1)+geom_line(aes(y=NIL.FI.ratio,)) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=2)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=2) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))
ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS4")
# PART 2 #
data<-import("FRB_Z1.csv")
data<-data %>% slice(-c(1:5))
data<-data %>% mutate(across(everything(),as.numeric))
names<-colnames(data)
names<-str_replace_all(names, "Nonfinancial corporate business; ","")
names<-str_replace_all(names," ", ".")
names<-str_replace_all(names, ";", "_")
colnames(data)<-names
data<-data %>% rename("Total_internal_funds"="gross.saving.including.foreign.earnings.retained.abroad.less.net.capital.transfers.paid",
"FI"="gross.fixed.investment",
"Net_acquisition_assets"="total.financial.assets",
"Net_lending_borrowing"="net.lending.(+).or.borrowing.(-).(financial.account)",
"year"="Series.Description")
data<-data %>% select(year, Total_internal_funds, FI, Net_acquisition_assets, Net_lending_borrowing)
data<-data %>% mutate(Net_increase_liabilities=Net_acquisition_assets-Net_lending_borrowing)
data<-data %>% mutate(IF.FI.ratio=Total_internal_funds/FI, NIL.FI.ratio=Net_increase_liabilities/FI)
plot1<-ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1
ggsave("plot1.png")
plot1<-ggplot(data, aes(x=year))+ geom_line(aes(y=IF.FI.ratio, color="orange"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
ggsave("plot1.png")
plot2<-ggplot(data, aes(x=year))+geom_line(aes(y=Total_internal_funds,color="wheat"))
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities,color="green4"),size=1.5)+
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities,color="green4"),size=1.5)
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color=wheat),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color=green4),size=1.5)
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds),size=1.5)+
geom_line(aes(y=Net_increase_liabilities),size=1.5)
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(fill="#FFDB6D",aes(y=Total_internal_funds),size=1.5)+
geom_line(aes(y=Net_increase_liabilities),size=1.5)
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)
plot2
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio, color="orange"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="purple"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")+
scale_colour_manual(values = c("red", "blue", "green"))
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")+
scale_colour_manual(values = c("red", "blue", "green"))
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")+
scale_colour_manual(values = c("red", "blue", "green"))
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")+
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
?scale_color_discrete
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
+ scale_color_manual(values=c("#CC6666", "#9999CC"))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
+ scale_color_manual(values=c("#CC6666", "#9999CC"))
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_manual(values=c("#CC6666", "#9999CC"))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(color="blue,"aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-ggplot(data, aes(x=year))+
geom_line(color="blue",aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
plot1
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(color="purple",aes(y=IF.FI.ratio),size=1.5)+
geom_line(aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(color="purple", aes(y=IF.FI.ratio),size=1.5)+
geom_line(color="red", aes(y=NIL.FI.ratio),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio,color),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio,color="x"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="y"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
ggsave("plot1.png")
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green4"),size=1.5)
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))+
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))+
theme(legend.position = "bottom")
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
xlab("Year")+ylab("Flow")
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))+
theme(legend.position = "bottom")
plot2
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
xlab("Year")+ylab("Flow")+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))+
theme(legend.position = "bottom")
plot2
ggsave("plot2.png")
knitr::opts_chunk$set(echo = TRUE)
load("plot2.png")
plot1<-ggplot(data, aes(x=year))+
geom_line(aes(y=IF.FI.ratio,color="x"),size=1.5)+
geom_line(aes(y=NIL.FI.ratio,color="y"),size=1.5) +
theme_bw() + xlab("Year") +ylab("Ratio") +
scale_color_discrete(name="Flow Type",labels=c("Internal Funds/Fixed Investment", "Net Increase in Liabilities/ Fixed Investment"))+
theme(legend.position = "bottom")
plot1<-plot1+scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))
plot1
ggsave("PS4plot1.png")
plot2<-ggplot(data, aes(x=year))+ theme_bw()+
geom_line(aes(y=Total_internal_funds,color="wheat"),size=1.5)+
geom_line(aes(y=Net_increase_liabilities, color="green4"),size=1.5)+
geom_line(aes(y=FI, color="green5"),size=1.5)+
xlab("Year")+ylab("Flow")+
scale_x_continuous(breaks=c(1950,1960,1970,1980,1990,2000,2010,2020))+
scale_color_discrete(name="Flow Type",labels=c("Internal Funds", "Net Increase in Liabilities","Fixed Investment"))+
theme(legend.position = "bottom")
plot2
ggsave("PS4plot2.png")
load("PS4plot1.png")
```{r,  fig.cap="Inflation with 3 different indices", out.width = '75%',fig.align = 'center'}
library(stringr)
library(alfred)
library(aTSA)
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
View(BAA)
View(FEDFUNDS)
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/Problem-Sets--753/PS5")
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
View(BAA)
ggplot(BAA, aes(x=date,y=BAA))+geom_line()
